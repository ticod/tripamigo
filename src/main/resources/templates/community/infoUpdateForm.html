<!DOCTYPE html>
<html th:replace="~{/fragment/layout :: layout(~{::title}, ~{::section}, ~{::style})}">
  <title>Tripamigo | INFO</title>
  <style>
  a{text-decoration:none;}
  </style>

<body>

<!-- Main Contents -->
<section class="w3-center w3-container" >
  <b class="w3-center w3-xxlarge w3-sans-serif">Info</b>
  <p class="w3-center w3-sans-serif">게시글쓰기</p><hr><br>
 
  <script th:inline="javascript">
  	function cancel(){
  		if(confirm("작성을 취소하시겠습니까?") == true){
			location.href="/community/magazine";	
		}else{
			return;
		}
  	}
  	function fileChk(){
  		var imgFile = $('#file').val();
  		var fileForm = /(.*?)\.(jpg|jpeg|png|gif|bmp)$/;
  		var maxSize = 1 * 1024 * 1024;
		var fileSize;
		if(imgFile != "" && imgFile != null) {
			fileSize = document.getElementById("file").files[0].size;
    		if(!imgFile.match(fileForm)) {
    			alert("jpb, jpeg, png, gif, bmp만 업로드 가능");
        		return false;
    		} else if(fileSize >= maxSize) {
    			alert("파일 사이즈는 1MB까지 가능");
        		return false;
    		}
		}
		return true;
  	}
  </script>
<script type="text/javascript" src="http://cdn.ckeditor.com/4.5.7/full/ckeditor.js"></script>
	<form id="infoForm" role="form" onsubmit="return fileChk()" th:object="${infoFormDTO}" action="updateInfo"  method="post">
		<div class="w3-table w3-centered" style="width:100%;">
			<div>
				<input type="text" class="w3-input w3-border" th:field="*{subject}" placeholder="제목 입력">
				<p th:if="${#fields.hasErrors('subject')}" th:errors="*{subject}">subject Error</p>
			</div>
			
			<br><br><br><hr><br><br><br>
			<script th:inline="javascript">
				function numberWithCommas(x) {
 					x = x.replace(/[^0-9]/g,'');   // 입력값이 숫자가 아니면 공백
  					x = x.replace(/,/g,'');          // ,값 공백처리
 					$("#money").val(x.replace(/\B(?=(\d{3})+(?!\d))/g, ",")); // 정규식을 이용해서 3자리 마다 , 추가
 					console.log($("#money").val()) 
				}
			
			</script>
			<div class="" id="map">구글 맵 api 들어갈 자리</div>
			<div>
				<select th:field="*{rating}">
					<option selected value=0>장소에 대한 별점을 선택하세요</option><option value=1>1</option><option value=2>2</option><option value=3>3</option>
					<option value=4>4</option><option value=5>5</option><option value=6>6</option>
					<option value=7>7</option><option value=8>8</option><option value=9>9</option>
					<option value=10>10</option>
				</select>
			</div>
			<br>
			<div>
				<input type="text" th:field="*{budget}" placeholder="소요예산" id="money" onkeyup="numberWithCommas(this.value)">원
				<input type="text" th:field="*{name}" placeholder="장소명">
				<input type="text" th:field="*{address}" placeholder="주소">
				<input type="text" th:field="*{lat}" placeholder="위도">
				<input type="text" th:field="*{lng}" placeholder="경도">
				
				<p th:if="${#fields.hasErrors('rating')} " th:errors="*{rating}">Area Errors</p>
				<p th:if="${#fields.hasErrors('budget')} " th:errors="*{budget}">Area Errors</p>
				<p th:if="${#fields.hasErrors('name')} " th:errors="*{name}">Area Errors</p>
				<p th:if="${#fields.hasErrors('address')} " th:errors="*{address}">Area Errors</p>
				<p th:if="${#fields.hasErrors('lat')} " th:errors="*{lat}">Area Errors</p>
				<p th:if="${#fields.hasErrors('lng')} " th:errors="*{lng}">Area Errors</p>
				
			</div>
			
			<br><br>
			<div>
				<textarea rows="15" th:field="*{content}" id="content1" style="width:100%; height:100%;" placeholder="내용 입력"></textarea>
				<p th:if="${#fields.hasErrors('content')}" th:errors="*{content}">content Error</p>
				<script th:inline="javascript">CKEDITOR.replace("content1",{filebrowserImageUploadUrl:"/community/imgupload"})</script>
			</div>
			<div>
				
				<hr>
				
		    </div>
			
			<div>
				<input type="hidden" name="infoSeq" th:value="${infoSeq}">
				<input type="submit" value="작성완료" class="w3-btn w3-blue w3-round-xlarge">
				<input type="button" onclick="cancel()" value="작성취소" class="w3-btn w3-blue-grey w3-round-xlarge">
			</div>
		</div>
	</form>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
				<script th:inline="javascript">
					
				</script>
				<hr>
				
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAz1W2lasXllO19MekQuhZgVKYRYAGQYdg&callback=initMap&libraries=&v=weekly"
	async>
	</script>
				<script>
				
		function initMap() {
			var map = new google.maps.Map(document.getElementById('map'), {AIzaSyAz1W2lasXllO19MekQuhZgVKYRYAGQYdg});
		}
		window.onload = initMap();
		
				
				</script>
</section>
</body>
</html>